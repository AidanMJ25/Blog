<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>A Raspberry Pi Stream Deck Server controlled by ESPHome - Aidan Maurin-Jones</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="Aidan Maurin-Jones" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Aidan Maurin-Jones</div>
					
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/contact/">
				
				<span class="menu__text">Contact</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/newsletter/">
				
				<span class="menu__text">Newsletter Archive</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">A Raspberry Pi Stream Deck Server controlled by ESPHome</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2025-09-15T00:00:00Z">September 15, 2025</time></div></div>
		</header>
		<div class="content post__content clearfix">
			<p>I’ve turned one of my Raspberry Pi 4s into a dedicated Stream Deck hub. It’s hooked up to
a 32-button Stream Deck that controls devices and automations in Home Assistant, which runs
on a separate machine. The Pi’s only job is to sit there, listen, and push out commands —
but if it ever hangs or I need to reboot it, I wanted a way to manage it properly without
pulling cables.</p>
<p>That’s where the ESP32 comes in. I flashed it with ESPHome and wired it straight into the
Pi’s GPIO pins so I can treat the whole setup like a real smart-home appliance: I can power
it on, shut it down safely, reboot it, and always know its current state inside Home Assistant.</p>
<p>⸻</p>
<h3 id="how-i-wired-it">How I Wired It</h3>
<p>The wiring is pretty simple. Raspberry Pi GPIO14 goes into ESP32 GPIO27, which gives me
feedback about whether the Pi is on or off. The Pi’s RUN pins are connected to ESP32 GPIO13,
so I can pulse them to power it on. For shutdown and reboot, I used GPIO26 and GPIO13 on the
Pi, wired to ESP32 pins that trigger those actions.</p>
<p>This way, the ESP32 can send commands to the Pi, and the Pi can talk back about its state.</p>
<p>⸻</p>
<h3 id="my-esphome-config">My ESPHome Config</h3>
<p>On the ESP32, I wrote an ESPHome config with a few pieces:</p>
<ul>
<li>A template switch that acts as the main power control. It checks the binary sensor to
see if the Pi is already on before trying to pulse the RUN pins.</li>
<li>A shutdown switch that pulls Pi GPIO26 high, which my shutdown script listens for.</li>
<li>A reboot button that does the same thing with GPIO13 for rebooting.</li>
<li>A binary sensor tied to GPIO14 that tells me if the Pi is running or not.</li>
</ul>
<p>Here’s the core YAML I’m running:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">switch</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">platform</span>: <span style="color:#ae81ff">template</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Raspberry Pi Switch&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">id</span>: <span style="color:#ae81ff">raspberry_pi_switch</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">lambda</span>: |-<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      return id(raspberry_pi_power_state).state;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">turn_on_action</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">if</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">condition</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">lambda</span>: <span style="color:#e6db74">&#39;return !id(raspberry_pi_power_state).state;&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">then</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">switch.turn_on</span>: <span style="color:#ae81ff">turn_on_pi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">turn_off_action</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">switch.turn_on</span>: <span style="color:#ae81ff">turn_off_pi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">platform</span>: <span style="color:#ae81ff">gpio</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Turn On Raspberry Pi&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">pin</span>: <span style="color:#ae81ff">GPIO13</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">inverted</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">id</span>: <span style="color:#ae81ff">turn_on_pi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">internal</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">on_turn_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">delay</span>: <span style="color:#ae81ff">500ms</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">switch.turn_off</span>: <span style="color:#ae81ff">turn_on_pi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">platform</span>: <span style="color:#ae81ff">gpio</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Shutdown Raspberry Pi&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">pin</span>: <span style="color:#ae81ff">GPIO12</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">id</span>: <span style="color:#ae81ff">turn_off_pi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">internal</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">on_turn_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">delay</span>: <span style="color:#ae81ff">500ms</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">switch.turn_off</span>: <span style="color:#ae81ff">turn_off_pi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">platform</span>: <span style="color:#ae81ff">gpio</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Reboot Raspberry Pi&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">pin</span>: <span style="color:#ae81ff">GPIO14</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">id</span>: <span style="color:#ae81ff">reboot_pi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">internal</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">on_turn_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">delay</span>: <span style="color:#ae81ff">500ms</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">switch.turn_off</span>: <span style="color:#ae81ff">reboot_pi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">binary_sensor</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">platform</span>: <span style="color:#ae81ff">gpio</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">pin</span>: <span style="color:#ae81ff">GPIO27</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Raspberry Pi Power State&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">id</span>: <span style="color:#ae81ff">raspberry_pi_power_state</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">device_class</span>: <span style="color:#ae81ff">power</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">filters</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">delayed_on_off</span>: <span style="color:#ae81ff">800ms</span>
</span></span></code></pre></div><p>⸻</p>
<h3 id="the-pi-side">The Pi Side</h3>
<p>On the Raspberry Pi, I wrote two tiny Python scripts. One listens on GPIO26 and calls shutdown
now, the other listens on GPIO13 and calls reboot. They just loop forever in the background,
waiting for a HIGH signal from the ESP32:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#75715e"># shutdown_monitor.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> RPi.GPIO <span style="color:#66d9ef">as</span> GPIO<span style="color:#f92672">,</span> time<span style="color:#f92672">,</span> os
</span></span><span style="display:flex;"><span>GPIO<span style="color:#f92672">.</span>setmode(GPIO<span style="color:#f92672">.</span>BCM)
</span></span><span style="display:flex;"><span>GPIO<span style="color:#f92672">.</span>setup(<span style="color:#ae81ff">26</span>, GPIO<span style="color:#f92672">.</span>IN, pull_up_down<span style="color:#f92672">=</span>GPIO<span style="color:#f92672">.</span>PUD_DOWN)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> GPIO<span style="color:#f92672">.</span>input(<span style="color:#ae81ff">26</span>) <span style="color:#f92672">==</span> GPIO<span style="color:#f92672">.</span>HIGH:
</span></span><span style="display:flex;"><span>        os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;sudo shutdown now&#34;</span>)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># reboot_pi.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> RPi.GPIO <span style="color:#66d9ef">as</span> GPIO<span style="color:#f92672">,</span> time<span style="color:#f92672">,</span> os
</span></span><span style="display:flex;"><span>GPIO<span style="color:#f92672">.</span>setmode(GPIO<span style="color:#f92672">.</span>BCM)
</span></span><span style="display:flex;"><span>GPIO<span style="color:#f92672">.</span>setup(<span style="color:#ae81ff">13</span>, GPIO<span style="color:#f92672">.</span>IN, pull_up_down<span style="color:#f92672">=</span>GPIO<span style="color:#f92672">.</span>PUD_DOWN)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> GPIO<span style="color:#f92672">.</span>input(<span style="color:#ae81ff">13</span>) <span style="color:#f92672">==</span> GPIO<span style="color:#f92672">.</span>HIGH:
</span></span><span style="display:flex;"><span>        os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;sudo reboot&#34;</span>)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.5</span>)
</span></span></code></pre></div><p>I wrapped both of these in simple systemd services so they start automatically on boot and
restart if they crash. That way, the Pi is always listening for signals from the ESP32.</p>
<p>⸻</p>
<h3 id="what-it-feels-like-in-practice">What It Feels Like in Practice</h3>
<p>Now, inside Home Assistant, the Pi just shows up like any other smart switch. If it’s off,
flipping the switch pulses the RUN pins and boots it up. If it’s on, flipping the switch
triggers the shutdown script and powers it down cleanly. There’s also a reboot button when I
need it. And the binary sensor tied to GPIO14 means I always know its current state.</p>
<p>The best part is how natural it feels. The Pi and Stream Deck live on my desk like a little
smart-home console, but behind the scenes it’s running with the same polish you’d expect from
a dedicated appliance. Everything is local, reliable, and integrated with the rest of my Home
Assistant setup.</p>
<p>It’s one of those projects where the wiring is simple, the software is lightweight, but the
result makes my whole setup feel more “finished.”</p>
<h3 id="apps-and-tools-used-for-this-project">Apps and Tools Used for this Project</h3>
<ul>
<li><a href="https://github.com/Patrick762/hassio-streamdeck">Stream Deck HACS Integration</a></li>
<li><a href="https://www.home-assistant.io/">Home Assistant</a></li>
<li><a href="https://esphome.io/">ESPHome - Smart Home Made Simple</a></li>
</ul>
<style>
  .amj-cta { display:flex; flex-direction:column; align-items:flex-start; gap:.5rem; }

  .amj-cta .bmc a { display:inline-block; line-height:0; }
  .amj-cta .bmc img { display:block; }

  .amj-cta .rss .rss-button {
    display:inline-flex; align-items:center; gap:.5em;
    padding:.5em 1em; background:#f26522; color:#fff!important;
    border-radius:.3em; font-weight:600; text-decoration:none; font-size:.75rem;
    transition:background-color .2s ease;
  }
  .amj-cta .rss .rss-button:hover { background:#d35400; }
  .amj-cta .rss .rss-button svg { fill:#fff!important; width:1.2em; height:1.2em; }

  .amj-cta .nl .newsletter-subscribe {
    display:inline-flex; align-items:center; gap:.5em;
    padding:.5em 1em; background:#2F8CFF; color:#fff!important;
    border-radius:.3em; font-weight:600; text-decoration:none; font-size:.75rem;
    transition:background-color .2s ease;
  }
  .amj-cta .nl .newsletter-subscribe:hover { background:#357ABD; }
</style>

<div class="amj-cta">
  <div class="bmc">
    <a href="https://www.buymeacoffee.com/AidanMJ25" target="_blank" rel="noopener">
      <img src="https://cdn.buymeacoffee.com/buttons/v2/arial-yellow.png" alt="Buy Me A Coffee" width="127" height="35" loading="lazy" decoding="async">
    </a>
  </div>

  <div class="rss">
    <a class="rss-button" href="https://aidanmaurinjones.com/posts/index.xml" target="_blank" rel="noopener" aria-label="Subscribe via RSS">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path d="M6.18 17.82a1.82 1.82 0 1 1 0-3.64 1.82 1.82 0 0 1 0 3.64Zm-3-8.18v2.73a8.64 8.64 0 0 1 8.64 8.64h2.73A11.36 11.36 0 0 0 3.18 9.64Zm0-4.09v2.73A15.45 15.45 0 0 1 18.55 23h2.73C21.27 11.73 12.45 2.91 3.18 5.55Z"/></svg>
      <span>Subscribe via RSS</span>
    </a>
  </div>

  <div class="nl">
    <a class="newsletter-subscribe" href="https://buttondown.com/AidanMJ25" target="_blank" rel="noopener">Newsletter via Email</a>
  </div>

  <div class="rss">
    <a class="rss-button" href="https://aidanmaurinjones.com/newsletter/index.xml" target="_blank" rel="noopener" aria-label="Newsletter via RSS">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path d="M6.18 17.82a1.82 1.82 0 1 1 0-3.64 1.82 1.82 0 0 1 0 3.64Zm-3-8.18v2.73a8.64 8.64 0 0 1 8.64 8.64h2.73A11.36 11.36 0 0 0 3.18 9.64Zm0-4.09v2.73A15.45 15.45 0 0 1 18.55 23h2.73C21.27 11.73 12.45 2.91 3.18 5.55Z"/></svg>
      <span>Newsletter via RSS</span>
    </a>
  </div>
</div>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/home-assistant/" rel="tag">Home Assistant</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/esphome/" rel="tag">ESPHome</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/stream-deck/" rel="tag">Stream Deck</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/raspberry-pi/" rel="tag">Raspberry Pi</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/ai/" title="AI">AI (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/alfred/" title="Alfred">Alfred (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/applescript/" title="AppleScript">AppleScript (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/automation/" title="Automation">Automation (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/bettertouchtool/" title="BetterTouchTool">BetterTouchTool (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/blogging/" title="Blogging">Blogging (5)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/buttondown/" title="Buttondown">Buttondown (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/esphome/" title="ESPHome">ESPHome (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/github-pages/" title="GitHub Pages">GitHub Pages (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/home-assistant/" title="Home Assistant">Home Assistant (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hugo/" title="Hugo">Hugo (6)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/markdown/" title="Markdown">Markdown (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/podcasts/" title="Podcasts">Podcasts (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/raspberry-pi/" title="Raspberry Pi">Raspberry Pi (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/shortcuts/" title="Shortcuts">Shortcuts (21)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/simple-automation/" title="Simple Automation">Simple Automation (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/smart-home/" title="Smart Home">Smart Home (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/stream-deck/" title="Stream Deck">Stream Deck (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/webscraping/" title="WebScraping">WebScraping (5)</a>
	</div>
</div><section class="widget clear-tags">
  <a class="all-posts-link" href="/">Clear All Selected Tags</a>
</section>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 Aidan Maurin-Jones.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>